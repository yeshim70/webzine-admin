<!DOCTYPE html>
<html>

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>INSPINIA | Main view</title>

    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link href="/font-awesome/css/font-awesome.css" rel="stylesheet">

    <link href="/css/animate.css" rel="stylesheet">
    <link href="/css/style.css" rel="stylesheet">

    <!--추가 스타일-->

</head>

<body>
    <div id="app">
        <div id="wrapper">

            <!--좌측 메뉴 영역-->
            <nav w3-include-html="./leftmenu.html" class="navbar-default navbar-static-side" role="navigation"></nav>
            
            
            <!--우측 영역-->
            <div id="page-wrapper" class="gray-bg">

                <!--우측 상단 영역 -->
                <div class="row border-bottom">
                    <nav class="navbar navbar-static-top white-bg" role="navigation" style="margin-bottom: 0">
                        <div class="navbar-header">
                            <a class="navbar-minimalize minimalize-styl-2 btn btn-primary " href="#"><i
                                    class="fa fa-bars"></i> </a>
                            <form role="search" class="navbar-form-custom" method="post" action="#">
                                <div class="form-group">
                                    <input type="text" placeholder="Search for something..." class="form-control"
                                        name="top-search" id="top-search">
                                </div>
                            </form>
                        </div>
                        <ul class="nav navbar-top-links navbar-right">
                            <li>
                                <a href="#">
                                    <i class="fa fa-sign-out"></i> Log out
                                </a>
                            </li>
                        </ul>

                    </nav>
                </div>

                <!--우측 콘텐츠 헤더영역 -->
                <div class="row wrapper border-bottom white-bg page-heading">
                    <div class="col-lg-10">
                        <h2>관리자정보관리</h2>
                        <ol class="breadcrumb">
                            <li>
                                <a href="/Home/Index">Home</a>
                            </li>
                            <li>
                                <a>관리자정보관리</a>
                            </li>
                            <li class="active">
                                <strong>조회</strong>
                            </li>
                        </ol>
                    </div>
                    <div class="col-lg-2">

                    </div>
                </div>

                <!--우측 콘텐츠 영역 -->
                <div class="wrapper wrapper-content">
                    <div class="ibox-content m-b-sm border-bottom">


                        <div class="row">
                            <div class="col-sm-4">
                                <div class="form-group">
                                    <label class="control-label">게시판유형</label>
                                    <select class="form-control" v-model="article.boardId">
                                        <option value="0">선택</option>
                                        <option v-for="board in boards" v-bind:value="board.id">{{ board.boardname }}
                                        </option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="form-group">
                                    <label class="control-label">게시글분류</label>
                                    <select class="form-control" v-model="article.categoryid">
                                        <option v-for="category in categories" v-bind:value="category.id">
                                            {{ category.categoryName }}</option>
                                    </select>
                                </div>
                            </div>

                            <div class="col-sm-4">
                                <div class="form-group">
                                    <label class="control-label">게시여부</label>
                                    <select class="form-control" v-model="article.displayyn">
                                        <option value="">선택</option>
                                        <option value="true">게시함</option>
                                        <option value="false">게시안함</option>
                                    </select>
                                </div>
                            </div>

                        </div>
                        <div class="row">
                            <div class="col-sm-12">
                                <div class="form-group">
                                    <label class="control-label">제목</label>
                                    <input type="text" v-model="article.title" class="form-control">
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-sm-12">
                                <div class="form-group">
                                    <label class="control-label">글내용</label>
                                    <textarea class="form-control" v-model="article.contents" rows="10"
                                        cols="5"></textarea>
                                </div>
                            </div>
                        </div>


                        <div class="text-center">
                            <button type="button" class="btn btn-primary" v-on:click="saveData">저장</button>
                            <a href="#" class="btn btn-info">목록</a>
                        </div>

                    </div>
                </div>

                <!--우측 하단 풋터 영역-->
                <div class="footer">
                    <div class="pull-right">
                        10GB of <strong>250GB</strong> Free.
                    </div>
                    <div>
                        <strong>Copyright</strong> Example Company &copy; 2014-2018
                    </div>
                </div>

            </div>
        </div>

    </div>

    <!-- Mainly scripts -->
    <script src="/js/jquery-3.1.1.min.js"></script>
    <script src="/js/popper.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/plugins/metisMenu/jquery.metisMenu.js"></script>
    <script src="/js/plugins/slimscroll/jquery.slimscroll.min.js"></script>

    <!-- Custom and plugin javascript -->
    <script src="/js/inspinia.js"></script>
    <script src="/js/plugins/pace/pace.min.js"></script>


    <!--추가 스크립트-->
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.10/dist/vue.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>

    <!--뷰로더 스크립트-->
    <script src="https://unpkg.com/http-vue-loader"></script>
    <script src="https://www.w3schools.com/lib/w3.js"></script>

    <script>

        //URL파라메터 조회함수
        $.urlParam = function (name) {
            var results = new RegExp('[\?&]' + name + '=([^&#]*)').exec(window.location.href);
            return results[1] || 0;
        }


        w3.includeHTML();


        //IDX값조회
        var id = $.urlParam('id');

        var app = new Vue({
            el: '#app',
            data: {
                boards: [],
                categories: [
                    { id: 0, categoryName: '선택' },
                    { id: 1, categoryName: 'Node.js' },
                    { id: 2, categoryName: 'Vue.js' },
                    { id: 3, categoryName: 'React.js' },
                    { id: 4, categoryName: 'Angular.js' },
                ],
                article: { }
            },
            created: function () {
                axios.get('/boards').then(function (response) {
                    this.boards = response.data
                }.bind(this))
                .catch(function (e) {
                    console.error(e);
                });

                axios.get('/articles/'+id).then(function (response) {
                    this.article = response.data
                }.bind(this))
                .catch(function (e) {
                    console.error(e);
                });
            },
            methods: {
                saveData: function () {

                    if (this.article.title == "") {
                        alert("제목을 입력해주세요.");
                        //this.$refs.title.focus();
                        return false;
                    }

                    if (this.article.contents == "") {
                        alert("글내용을 입력해주세요.");
                        return false;
                    }

                    axios.patch('/articles/'+id, this.article).then(function (response) {
                        location.href = "/articles/list.html";
                    }.bind(this))
                        .catch(function (e) {
                            console.error(e);
                        })
                }
            }

        });
    </script>

</body>

</html>